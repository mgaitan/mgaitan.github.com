<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="es">
<head>
<meta charset="utf-8">
<meta name="description" content="&gt;&gt;&gt; me.geek.post()">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>tin_nqn (posts antiguos, página 18) | tin_nqn  </title>
<link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="assets/css/code.css" rel="stylesheet" type="text/css">
<link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
<link href="assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="assets/css/custom.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" href="en/rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" href="rss.xml">
<link rel="canonical" href="http://mgaitan.github.io/index-18.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><script src="assets/js/jquery.min.js"></script>
</head>
<body>

<!-- Menubar -->

<nav class="navbar navbar-static-top" role="navigation"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://mgaitan.github.io/">

                <div id="blog-title">
                    tin_nqn
                    <span id="blog-description">&gt;&gt;&gt; me.geek.post()</span>
                </div>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
<li>
<a href="about.html">Sobre mí</a>
                </li>
<li>
<a href="charlas.html">Charlas</a>
                </li>
<li>
<a href="archive.html">Archivos</a>
                </li>
<li>
<a href="categories/index.html">Categorías</a>
                </li>
<li>
<a href="rss.xml">RSS</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right">
<li>            </li>
<li><a href="en/" rel="alternate" hreflang="en">English</a></li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container">
    <div class="body-content">
        <!--Body content-->
        <div class="row">

            <div class="col-md-offset-2 col-md-8">
            
    
    
<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/ext4-superblock-failure-y-la-cola-del-diablo/" class="u-url">Ext4 superblock failure y la cola del Diablo</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Martín Gaitán
            </span></p>
            <p class="dateline"><a href="posts/ext4-superblock-failure-y-la-cola-del-diablo/" rel="bookmark"><time class="published dt-published" datetime="2012-10-26T02:24:46-03:00" title="26/10/12 02:24:46">26/10/12 02:24:46</time></a></p>
                <p class="commentline">            <a href="posts/ext4-superblock-failure-y-la-cola-del-diablo/#disqus_thread" data-disqus-identifier="cache/posts/ext4-superblock-failure-y-la-cola-del-diablo.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>Domingo, ciudad de Guayaquil, todo dispuesto para salir a
conocer una ciudad que en las guías de viaje suena intererante y bonita.
Se me ocurre prender la compu para ver si ese email que mandé la noche
anterior, recién llegado después de 14 horas de viaje
(5 de espera en el aeropuerto de Santiago) y deseando únicamente
ducha y colchón, había sido contestado.</p>
<p><em>"No pusheé"</em>, fué lo primero que pensé, o me lo dije, en voz inaudible,
como eufemismo de un gran insulto y síntesis de <em>"Martincito querido,
ya sabés que el booteo está tardando mucho, el material para el taller_ que
tenés que dar mañana está en esa computadora y tiene al menos 10 horas
de trabajo offline que está en la última versión online: no podés ser tan
pelotudo y tener tan mal orto a la vez</em>". Mi voz interior sí que sabe
resumir.</p>
<p>Por suerte, no perdí la calma. Apreté el 1 en el teléfono: <em>"sí señor",  el
Bussiness Center queda en el 4 piso"</em>. Ahí fui y habia computadoras con
las que pude contactarme con Houston.</p>
<p>Grulic, <a class="reference external" href="https://twitter.com/perrito666">Perrito</a>,
<a class="reference external" href="http://verdumariano.com.ar/">Mariano</a>, Rudi, y especialmente
<a class="reference external" href="http://blog.ontrackdatarecovery.es/conoce-al-ingeniero-ernesto-lobo/">mi cuñado que trabaja en Ontrack</a>
y era algo así como un Messi sentado en mi banco de suplentes
para este partido que yo no hubiese querido jugar, fueron los primeros
con quienes me comuniqué.</p>
<p>Mandé este mensaje:</p>
<blockquote>
<p>Gente, les mando una de Murphy y el diablo y toda la mala leche junta.
Estoy en Ecuador invitado a dar un curso-taller de Python y Django.</p>
<p>Rodo venía fantastico , hasta que hoy enciendo la laptop y no y no entra el sistema operativo!.</p>
<p>Entro en modo recuperacion (ubuntu 11.10) y se clava en el <tt class="docutils literal">fsck</tt>
hasta que me aparece un menucito que me deja entrar a una consola root.
Lo peor sucedió <tt class="docutils literal">/home/</tt> no monta , pero el <tt class="docutils literal">/</tt>
parece estar sano. Ambas son una particion <tt class="docutils literal">ext4</tt></p>
<p>Si intento montar a mano o un fsck, el output dice muchas cosas que
suenan mal pero no tengo puta idea qué significan:</p>
<pre class="literal-block">
STATUS { DRDY }
ERROR { UNC }
configured for UDMA/133
failed command READ DMA
exception Emask 0x0 Sact 0x0 Serr 0x0 action 0x0
res 51/40... Emask 0x9 (media error)
</pre>
<p>Por favor, iluminenmé sobre cómo proceder.</p>
</blockquote>
<p>Ernesto contestó. Primero intentar hacer un un live-usb con algunas
herramientas de diagnostico: <a class="reference external" href="http://ubuntu-rescue-remix.org/">Ubuntu-rescue-remix</a>
podría funcionar, pero las maquinas del Bussiness center no me dejan
instalar algun <a class="reference external" href="http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/">programita</a>
para pasar la ISO al pendrive.</p>
<p>Empiezo a deseperar ya pensar si no conviene aprovechar el tiempo que me llevará
intentar un salvataje con alta probabilidad de fracaso para rehacer el
trabajo inaccesible.</p>
<p>Desactivar journal, no. Forzar montado, no. No se qué otra cosa, no.</p>
<p>Ernesto pregunta si me animo a ir por el camino duro.</p>
<blockquote>
Cómo estás de fresco ara leer hexadecimal ? <tt class="docutils literal">hexdump</tt> y <tt class="docutils literal">dd</tt>, la navaja suiza.
que necesitamos</blockquote>
<p>Intentamos algunas cosas, calculadora en mano,
pero la mayoría de los intentos de acceso al disco
caen en el mismo bucle de errores horribles. Mucho calor en Guayaquil.</p>
<p>Le digo a Ernesto (domingo, dia de descanso) que no se preocupe, que intentemos
eso último que se le ocurrió pero que si no funciona voy a ponerme a trabajar
de nuevo. Mientras tanto, el Dios en el que no creo me pone
<a class="reference external" href="http://linuxexpresso.wordpress.com/2010/03/31/repair-a-broken-ext4-superblock-in-ubuntu/">este link</a>
en el camino de resultados de Google.</p>
<p>"Ernesto, prabamos esto?" y no alcanzó a contestar
antes de que esté poniendo los primeros comandos</p>
<pre class="code bash"><a name="rest_code_f46711931a5841729155d75a4e9a2aed-1"></a>$ sudo mke2fs -n /dev/sda3
<a name="rest_code_f46711931a5841729155d75a4e9a2aed-2"></a>
<a name="rest_code_f46711931a5841729155d75a4e9a2aed-3"></a>Superblock backups stored on blocks:
<a name="rest_code_f46711931a5841729155d75a4e9a2aed-4"></a><span class="m">32768</span>, <span class="m">98304</span>, <span class="m">163840</span>, <span class="m">229376</span>, <span class="m">294912</span>, <span class="m">819200</span>, <span class="m">884736</span>, <span class="m">1605632</span>, <span class="m">2654208</span>
</pre>
<p>Me la juego con el primer backup:</p>
<pre class="code bash"><a name="rest_code_70d499ae29c5478e98de284af1035d73-1"></a>sudo e2fsck -b <span class="m">32768</span> /dev/sda3
</pre>
<p>Cientos de  <tt class="docutils literal">Y</tt> <tt class="docutils literal">Enter</tt> para mensajes estilo <em>"está roto, desea repararlo?"</em>
(no había una opción "Sí a todo", como si uno fuese capaz de arrepentirse
a mitad de camino)</p>
<p>Anduvo. Uff. Dos simples comandos.
El Ingeniero Lobo festeja desde Londres, Skype mediante,
que podía volver a limpiar su moto sin quedar mal con su cuñado con mala
pata. Me dijo antes:</p>
<blockquote>
Si no hubiese sido una situadion del tipo <em>mañana
ya no me sirven los datos</em> yo te hubiera  recomendado en contra
de herramienta como <tt class="docutils literal">e2fsck</tt>. Esos programas sólo se encargan
de asegurar que el filesystem esté íntegro, pero si para eso tienen
que cortarlo a la mitad lo hacen sin dudar.
Son como doctores de guerra: te dejan vivo, pero sin una pierna y un
brazo.</blockquote>
<p>Querido Guayaquil: prometo visitar tu Malecón la próxima,
<strong>push</strong> por adelantado.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/notas-rapidas-de-una-mudanza/" class="u-url">Notas rápidas de una mudanza</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Martín Gaitán
            </span></p>
            <p class="dateline"><a href="posts/notas-rapidas-de-una-mudanza/" rel="bookmark"><time class="published dt-published" datetime="2012-10-14T19:23:44-03:00" title="14/10/12 19:23:44">14/10/12 19:23:44</time></a></p>
                <p class="commentline">            <a href="posts/notas-rapidas-de-una-mudanza/#disqus_thread" data-disqus-identifier="cache/posts/notas-rapidas-de-una-mudanza.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>Hace unos días abría este espacio prometiendo migrar contenidos y
tratar de que se vea un poco más bonito.</p>
<p>Este post incluye algunas notas sobre lo que he hecho hasta el momento.</p>
<div class="section" id="github-nikola">
<h2>Github ♥ Nikola</h2>
<p>Este blog que estás leyendo está hospedado en <a class="reference external" href="http://pages.github.com">Github Pages</a> ,
el servicio de hosting gratuito de contenido estático que ofrece Github.</p>
<p>A diferencia de cuando se usa Gh-pages para proyectos, donde se sirve
el contenido del branch <em>gh-page</em> del proyecto en cuestión,
para usar gh-pages por usuario hay que crear
un repo llamado <em>&lt;username&gt;</em>.github.com (donde <em>&lt;username&gt;</em> es el tuyo)
y lo que sirve en <a class="reference external" href="http:/">http:/</a>/&lt;username&gt;.github.com es directamente el branch
<em>master</em> (<a class="reference external" href="https://help.github.com/articles/user-organization-and-project-pages">referencia</a>)</p>
<p>Por este motivo creé otro branch (que sin mucha imaginación denominé
<a class="reference external" href="https://github.com/mgaitan/mgaitan.github.com/tree/writing">writing</a> )
donde tengo todo el mi "proyecto" hecho con Nikola</p>
<p>Allí escribo, intento mejorar mi <a class="reference external" href="https://github.com/mgaitan/mgaitan.github.com/tree/writing/themes/custom">theme</a>, y corro <tt class="docutils literal">nikola build</tt>.</p>
<p>El branch master es el de deploy y sirve todo lo que haya en la carpeta
<tt class="docutils literal">output/</tt> del branch <tt class="docutils literal">writing</tt>. Para hacer <a class="reference external" href="http://stackoverflow.com/a/10591668">esto</a> hay que ir a <em>master</em>,
borrar todo y leer desde el árbol del otro branch con <tt class="docutils literal"><span class="pre">read-tree</span></tt></p>
<pre class="literal-block">
git checkout master
git rm *    # sólo la primera vez
git read-tree writing:output
git commit -m 'deploying last build'
git push
</pre>
</div>
<div class="section" id="migrando-desde-spip">
<h2>Migrando desde Spip</h2>
<p>Uno de los motivos que me llevaron a migrar desde <a class="reference external" href="http://www.spip.net">Spip</a> es que el markup
que usa es <em>ad hoc</em> y muy feo. Algo así</p>
<pre class="literal-block">
{{{ Un intertítulo }}}

Esto es {{negrita}} y este [mi twitter-&gt;http://twitter.com/tin_nqn_]
</pre>
<p>Hasta ahí no se ve tan mal, pero es muy limitado cuando se trata de mostrar
código, necesario en todo blog mas o menos técnico.</p>
<p>Para migrar esquivé la idea de convertir el markup de spip y opté por un
scrapping, limpieza y conversión a restructuredText usando el mágico
<a class="reference external" href="http://johnmacfarlane.net/pandoc">Pandoc</a> (y la ayuda de PyQuery)</p>
<p>El script que hice está
<a class="reference external" href="https://github.com/mgaitan/mgaitan.github.com/blob/writing/tools/spip_converter.py">acá</a>
. No es perfecto, pero está lo importante: contenidos, imágenes, adjuntos,
convertido a restructuredText bastante decente que mejoraré poco a poco
a mano.</p>
</div>
<div class="section" id="estilos">
<h2>Estilos</h2>
<p>Es mentira que a los ñoños no nos gustan las cosas (los blogs, entre otras)
que se ven bonitos. Sucede, en realidad, que la mayoría de las veces no
venimos con <em>esa</em> habilidad y el esfuerzo que nos implica intentarlo
preferimos ponerlo en otra cosa. No gusta, pero no es lo más importante.</p>
<p>No obstante, yo quiero que este espacio sea lindo y legible. Y como hay
muchos otros ñoños con sitios lindos y legibles que son tan amables de
compartir sus estilos (y existe <a class="reference external" href="http://twitter.github.com/bootstrap">bootstrap</a>, claro) voy a ir intentándolo,
incrementalmente.</p>
<p>Por ahora tomé ideas y CSS de <a class="reference external" href="http://stevelosh.com">stevelosh.com</a> <a class="footnote-reference" href="posts/notas-rapidas-de-una-mudanza/#id3" id="id1">[1]</a> y de la documentación
de <a class="reference external" href="http://flask.pocoo.org/docs/">Flask</a> <a class="footnote-reference" href="posts/notas-rapidas-de-una-mudanza/#id4" id="id2">[2]</a> basado en el theme <em>Readable</em> de <a class="reference external" href="http://bootswatch.com/">bootswatch.com</a></p>
</div>
<div class="section" id="disqus">
<h2>Disqus</h2>
<p>El blog viejo usaba <a class="reference external" href="http://disqus.com">Disqus</a>, con un <a class="reference external" href="http://mgaitan.github.com/posts/disqus-para-spip.html">plugin</a> que hice hace algun tiempo.
Para migrar los comentarios utilicé el método de subir un CSV con
el formato que genera el mismo script de migración:</p>
<pre class="literal-block">
URL_POST_X_OLD, URL_POST_X_NEW
URL_POST_Y_OLD, URL_POST_Y_NEW
</pre>
<p>En cuestión de minutos los (pocos) comentarios estaban migrados.</p>
</div>
<div class="section" id="redireccion">
<h2>Redirección</h2>
<p>Como mantuve el slug de los viejos artículos, una redirección 301
via .htaccess redirige del viejo blog al nuevo:</p>
<pre class="literal-block">
# nqnwebs.com blog rules
RewriteCond %{HTTP_HOST} ^nqnwebs [nc]
RewriteRule ^blog[/]?$ http://mgaitan.github.com/ [R=301]
RewriteRule ^blog/article/(.*)$ http://mgaitan.github.com/posts/$1.html [R=301]
</pre>
<p>¿Cómo se va viendo?</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/notas-rapidas-de-una-mudanza/#id1">[1]</a></td>
<td><a class="reference external" href="https://bitbucket.org/sjl/stevelosh/src/6432040d5154/LICENSE?at=default">https://bitbucket.org/sjl/stevelosh/src/6432040d5154/LICENSE?at=default</a></td>
</tr></tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup>
<col class="label">
<col>
</colgroup>
<tbody valign="top"><tr>
<td class="label"><a class="fn-backref" href="posts/notas-rapidas-de-una-mudanza/#id2">[2]</a></td>
<td><a class="reference external" href="https://github.com/mitsuhiko/flask-sphinx-themes/blob/master/LICENSE">https://github.com/mitsuhiko/flask-sphinx-themes/blob/master/LICENSE</a></td>
</tr></tbody>
</table>
</div>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/bienvenidos-al-tren/" class="u-url">Bievenidos al tren</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Martín Gaitán
            </span></p>
            <p class="dateline"><a href="posts/bienvenidos-al-tren/" rel="bookmark"><time class="published dt-published" datetime="2012-10-11T01:15:00-03:00" title="11/10/12 01:15:00">11/10/12 01:15:00</time></a></p>
                <p class="commentline">            <a href="posts/bienvenidos-al-tren/#disqus_thread" data-disqus-identifier="cache/posts/1.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>Hola!</p>
<p>Este blog está en pleno proceso de mudanza y metamorfosis. Antes estaba
en <a class="reference external" href="http://nqnwebs.com/blog">http://nqnwebs.com/blog</a> y utilizaba <a class="reference external" href="http://www.spip.net">SPIP</a>. Por diversas razones
que explicaré más adelante, estoy migrandolo a <a class="reference external" href="http://nikola.ralsina.com.ar">Nikola</a> utilizando
<a class="reference external" href="http://github.com">Github</a> como plataforma de versionado y hosting.</p>
<p>Espero que pronto esto esté más bonito y con contenido. También que la
mudanza y el cambio de herramienta (y paradigma) me ayude a escribir más.</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/de-mercurial-a-git-limpieza/" class="u-url">De mercurial a git, limpieza mediante</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Martín Gaitán
            </span></p>
            <p class="dateline"><a href="posts/de-mercurial-a-git-limpieza/" rel="bookmark"><time class="published dt-published" datetime="2012-07-02T17:39:11-03:00" title="02/07/12 17:39:11">02/07/12 17:39:11</time></a></p>
                <p class="commentline">            <a href="posts/de-mercurial-a-git-limpieza/#disqus_thread" data-disqus-identifier="cache/posts/de-mercurial-a-git-limpieza.html">Comments</a>


        </p>
</div>
    </header><div class="p-summary entry-summary">
    <div>
<p>Cuando decidí dar el salto desde Subversion a un DVCS estuve leyendo
muchos posts comparativos entre las dos opciones más relevantes, Git y
Mercurial. Había que elegir entre <a class="reference external" href="http://importantshock.wordpress.com/2008/08/07/git-vs-mercurial/">Mc Gyver o James
Bond</a>
decía uno, entre <a class="reference external" href="http://www.ericsink.com/entries/hg_denzel.html">Denzel Washington y Wesley
Snipes</a> y la
comparación jocosa entre estos dos grandes softwares se volvió una
especie de meme tácito.</p>
<p>Sabía que, a fin de cuentas, tenía que probarlos y ver cual encajaba
mejor para mis necesidades de "solo developer". En el medio leí <a class="reference external" href="http://hginit.com/">Hg
Init</a> del gran divulgador Joel Spolsky y, víctima
de semejante labia, me sumergí para ese lado.</p>
<p>Mi flujo de trabajo era bastante básico pero suficiente y superador de
subvesion. Comparado con lo que había probado de Git era mucho menos
verbósico (no podía entender la necesidad de Git hacer <tt class="docutils literal">add</tt> cada vez
que quería commitear un archivo modificado) y
<a class="reference external" href="http://bitbucket.org">Bitbucket</a> daba no sólo hospedaje gratuito para
repositorios públicos sino también para potenciales desarrollos privados
(cosa que GitHub, su equivalente — siendo benévolo con bitbucket — para
Git, no daba).</p>
<p>Con el tiempo empecé a compatir <a class="reference external" href="https://bitbucket.org/tin_nqn/cuevanalinks">algunos
proyectitos</a> con otros
desarrolladores y mi inexperiencia en Mercurial me empezó a jugar en
contra. Y justo cuando necesitaba ponerme a aprender más profundamente
Hg, entre a laburar, muy a gusto, en
<a class="reference external" href="http://machinalis.com">Machinalis</a> (qué vago, nunca conté nada por
acá) donde usamos Git para el control de versiones de los proyectos,
implementando <a class="reference external" href="http://nvie.com/posts/a-successful-git-branching-model/">esta política de ramificación y
mezcla</a>.</p>
<p>Resultó entonces que en poquito tiempo ya sabía mucho más de Git que de
Mercurial (con la ventaja de tenerlo a Daniel Moisset cerca para apagar
algunos incendios que encendí las primeras semanas).</p>
<p>Para más señales, Atlassian, la empresa detras de Bitbucket y principal
referente de Mercurial (junto con Selenic, la creadora), comenzó a
ofrecer Git (sin descartar mercurial) como sistema DVCS (comiéndose
alguna que otra gastada porque alguna vez comunicó una noticia parecida
como broma del dia de los inocentes).</p>
<p>Asi que llegó el dia que decidí mudar un proyecto en Mercurial a Git.
Atenti: las razones no son técnicas. No tengo suficiente conocimiento de
Mercurial (ni de Git) para decir que uno es mejor que el otro por tales
razones. Sólo es *mi experiencia*, que vino un poco por obligación. Y
sí, también, siguiendo un poco a la manada. Proyectos de la envergadura
de Django han migrado a Git (y, particularmente, a GitHub)</p>
<div class="section" id="la-limpieza">
<h2>La limpieza</h2>
<p>Soy de esos que se mudan seguido. "¿Asi que si te renuevo contrato me
aumentas 30 % el alquiler e igual te tengo que pagar comisión sin que
hagas nada? ¡Andá a cagar!" puedo imaginarme dialogando con algun agente
inmobiliario.</p>
<p>Esta no era la excepción y debía mudar un repositorio mercurial que a su
vez había sido mudado (en realidad, exportado desde el último commit, y
arrancando de 0) desde
<a class="reference external" href="http://code.google.com/p/gpec2010/">subversion</a>.</p>
<p>El detalle es que el repositorio original, y por ende el nuevo en
mercurial, tenia un montón de datos de documentación que era,
basicamente, todos los fuentes y muchos de los archivos generados del
reporte escrito de mi tesis.</p>
<p>El primer changeset en el flamante mercurial consistió en borrar todo
esa información innecesaria, pero que seguía allí, en el historial (uno
110Mb de datos que no necesitaba).</p>
<p>Así que ya que ahora iba a mudarme de nuevo, queria tirar a la basura
todas esas cajas de papeles que había metido en un caja y, si bien no la
veía, me ocupaban el placard.</p>
<p>Despues de darle vueltas, <a class="reference external" href="http://stackoverflow.com/questions/2684898/mercurial-remove-history#8819813">encontré una
punta</a>
usando la extensión <a class="reference external" href="http://mercurial.selenic.com/wiki/ConvertExtension#Converting_from_Mercurial">hg convert para obtener un subconjunto de repo
original</a>,
por ejemplo, partiendo de un determinado cambio.</p>
<ol class="arabic">
<li>
<p class="first">Primero, activar la extensión editando <tt class="docutils literal"><span class="pre">~/.hgrc</span></tt>:</p>
<pre class="literal-block">
[extensions]
convert =
</pre>
</li>
<li>
<p class="first">¡Tirar las cajas del placard!</p>
<pre class="literal-block">
$ hg convert --config convert.hg.startrev=1 repo_hg_orig/ repo_hg_liviano/
</pre>
</li>
</ol>
<p>En mi caso yo queria todo desde la revision 1. <strong>Atenti</strong>: como explica,
esto genera un repo totalmente nuevo, con ids distintos para los
changesets, de modo que no se puede mantener "sincronizados" ambos con
el mismo cambio (al menos no de manera directa).</p>
</div>
<div class="section" id="la-mudanza">
<h2>La mudanza</h2>
<p>Contra todo pronóstico fruto de mi prejuicio y desidia, migrar a git fue
extremadamente fácil usando
<a class="reference external" href="http://repo.or.cz/w/fast-export.git">hg-fast-export</a>.</p>
<ol class="arabic">
<li>
<p class="first">Obtener los scripts</p>
<pre class="literal-block">
$ git clone git://repo.or.cz/fast-export.git
</pre>
</li>
<li>
<p class="first">Convertir!</p>
<pre class="literal-block">
$ mkdir repo_git
$ cd repo_git
$ git init
$ ~/fast-export/hg-fast-export.sh -r ~/repo_hg_liviano/ --force
</pre>
</li>
</ol>
<p>¡Charánnnn...!</p>
<p>El flag <tt class="docutils literal"><span class="pre">--force</span></tt> era necesario en mi caso porque, como explica el
<a class="reference external" href="http://repo.or.cz/w/fast-export.git/blob_plain/master:/hg-fast-export.txt">readme.txt</a>
<em>"hg-fast-export supports multiple branches but only named branches with
exaclty one head each..."</em>.</p>
<p>El resultado fue un repo git que ocupa el 5% (5.6mb) que el mercurial
original que sin perder la historia útil.</p>
<p>Parafraseando a Lito, <em>si la historia la escriben los que ganan</em> ...
¿ganamos ?</p>
<div class="youtube-video">
<iframe width="425" height="344" src="https://www.youtube.com/embed/3mkhn6oiqCM?rel=0&amp;hd=1&amp;wmode=transparent"></iframe>
</div>
</div>
</div>
    </div>
    </article>
</div>
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-19.html" rel="prev">Posts posteriores</a>
            </li>
            <li class="next">
                <a href="index-17.html" rel="next">Posts anteriores</a>
            </li>
        </ul></nav><script>var disqus_shortname="nqnwebs";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer>
                Contents © 2018         <a href="mailto:gaitan@gmail.com">Martín Gaitán</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/2.5/ar/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="http://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png"></a>
                
            </footer>
</div>
        </div>
        <!--End of body content-->


    </div>
</div>

            <script src="assets/js/bootstrap.min.js"></script><script src="assets/js/jquery.colorbox-min.js"></script><script src="assets/js/colorbox-i18n/jquery.colorbox-es.js"></script><script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><script src="assets/js/jquery.timeago.js" type="text/javascript"></script><script>
    jQuery(document).ready(function() {

        if(jQuery('html').attr('lang') === 'es'){
             jQuery.timeago.settings.strings = {
               prefixAgo: "hace",
               prefixFromNow: "dentro de",
               suffixAgo: "",
               suffixFromNow: "",
               seconds: "menos de un minuto",
               minute: "un minuto",
               minutes: "unos %d minutos",
               hour: "una hora",
               hours: "%d horas",
               day: "un día",
               days: "%d días",
               month: "un mes",
               months: "%d meses",
               year: "un año",
               years: "%d años"
            };
        }
        jQuery("time.published").timeago();

        jQuery('article:not(:first)').before('<hr>');

        jQuery('.highlight pre').addClass('code');
    });
    </script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-51074482-1', 'mgaitan.github.io');
      ga('send', 'pageview');

    </script>
</body>
</html>
